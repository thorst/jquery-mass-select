<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <style>
        .ddHide {
            margin-top: -1000000px;
        }
    </style>
    <script>
        var templates = {
            button: '<button type="button" class="multiselect dropdown-toggle" data-toggle="dropdown"></button>',
            ul: '<ul class="multiselect-container dropdown-menu"></ul>',
            filter: '<div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span><input class="form-control multiselect-search" type="text"></div>',
            li: '<li><a href="javascript:void(0);"><label>test</label></a></li>',
            divider: '<div class="divider"></div>',
            liGroup: '<li><label class="multiselect-group"></label></li>'
        };
        var
            createOptionValue = function (e) {
                return templates.li;
            },
            createOptions = function () {
                console.time('Create dropdownoptions');
                var lis = [];
                $select.children().each(function (index, element) {

                    // Support optgroups and options without a group simultaneously.
                    var tag = $(element).prop('tagName').toLowerCase();

                    if (tag === 'optgroup') {
                        //this.createOptgroup(element);
                    } else if (tag === 'option') {


                        lis.push(createOptionValue(element));


                    }


                });
                $ul.append(lis);
                console.timeEnd('Create dropdownoptions');
            }
        ;

        $(document).ready(function () {
            //Populate with some data
            console.time('Create source');
            var output = [];
            for (var i = 0; i < 10000; i++) {
                output.push('<option value="' + i + '"> Value #' + i + '</option>');
            };
            $('#multiselect').html(output.join(''));
            console.timeEnd('Create source');

            //Build dropdownoptions
            $select = $("#multiselect");
            $ul = $("#multiselect-ul");
            $cont = $("#multiselect-container");

            setTimeout(function () { createOptions(); }, 1);

            $("#showDropdown").click(function () {
                console.time('Toggle visibility');
                //  $cont.toggleClass("ddHide");
                console.log($cont.css('margin-top'));
                $cont.css('margin-top', $cont.css('margin-top')=='0px'?'-1000px':'0px');
                console.timeEnd('Toggle visibility');
                //  $ul[0].style.display = 'block'
                return false;
            });

        });
    </script>

</head>
<body>
    <select id="multiselect" multiple="multiple"></select>
    <div>
        <a id="showDropdown" href="#" class="btn btn-default">Dropdown trigger</a>
        <div id="multiselect-container" class="" style="overflow: hidden; position: absolute;margin-top:-1000px;">
            <div></div>
            <div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span><input class="form-control multiselect-search" type="text" placeholder="Search"></div>
            <ul><li><input type="checkbox" /> Select All</li></ul>
            <ul id="multiselect-ul" class="dropdown-menu " role="menu" aria-labelledby="dLabel" style=" max-height: 500px; overflow-y: auto; overflow-x: hidden; float: none; top: 0; display: block; position: Static;"></ul>
        </div>
    </div>

    <table class="table">
        <tr>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
        </tr>
        <tr>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
        </tr>
        <tr>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
            <td>
                hey
            </td>
        </tr>
    </table>
</body>
</html>
